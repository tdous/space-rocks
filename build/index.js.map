{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///../anim-loop-engine/lib/index.js","webpack:///./node_modules/easel-js/lib/draw/arc.js","webpack:///./node_modules/easel-js/lib/draw/line.js","webpack:///./node_modules/easel-js/lib/draw/mode.js","webpack:///./node_modules/easel-js/lib/index.js","webpack:///./src/entities/Bullet.ts","webpack:///./src/entities/Player.ts","webpack:///./src/entities/Rock.ts","webpack:///./src/index.ts","webpack:///./src/utils/math.ts"],"names":[],"mappings":";QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;AClFA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,qCAAqC;AACvE;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iC;;;;;;;;;;;;ACrDA;AAAA;AAAA;AAAsC;AAC/B;AACP;AACA;AACA,IAAI,0DAAY;AAChB;;;;;;;;;;;;;ACLA;AAAA;AAAA;AAAsC;AAC/B;AACP;AACA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA;AACA,IAAI,0DAAY;AAChB;;;;;;;;;;;;;ACZA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C,CAAC,8BAA8B;AACxB;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACxBA;AAAA;AAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AClCA;AAAA;AAAA;AACA;AACA,2BAA2B,OAAO;AAClC,2BAA2B,OAAO;AAClC,4BAA4B,QAAQ;AACpC,4BAA4B,QAAQ;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiB;;;;;;;;;;;;;ACblB;AAAA;AAAA;AACA;AACA,2BAA2B,OAAO;AAClC,2BAA2B,OAAO;AAClC,+BAA+B,WAAW;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiB;;;;;;;;;;;;;ACxClB;AAAA;AAAA;AACA;AACA,2BAA2B,OAAO;AAClC,2BAA2B,OAAO;AAClC,4BAA4B,QAAQ;AACpC,4BAA4B,QAAQ;AACpC,4BAA4B,QAAQ;AACpC,gCAAgC,YAAY;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,SAAS;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACe;;;;;;;;;;;;;ACrChB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAW,iBAAiB;AACsC;AAClE,WAAW,QAAQ;AACnB,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB,WAAW,OAAO;AACe;AACW;AACE;AACE;AACL;AACA;AACJ;AACvC;AACA;AACA;AACA;AACA,iBAAiB,0EAAc;AAC/B,gBAAgB,8CAAK,QAAQ,2BAA2B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,oEAAgB;AAC9B;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,cAAc;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA,6BAA6B,uCAAuC;AACpE;AACA;AACA;AACA,iBAAiB,uDAAM;AACvB;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA,oBAAoB,mDAAI;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,QAAQ;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,mEAAI;AACZ;AACA;AACA;AACA;AACA;AACA,wBAAwB,QAAQ;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,QAAQ;AAChC;AACA;AACA;AACA;AACA;AACA,qBAAqB,oEAAgB;AACrC;AACA;AACA,sBAAsB,oEAAgB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,oEAAgB;AAC9B,sBAAsB,uDAAM;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,iEAAG;AACX;AACA;AACA,qDAAqD,iCAAiC,EAAE;AACxF;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,QAAQ;AAChC,wBAAwB,QAAQ;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC5SA;AAAA;AAAA;AAAO;AACP;AACA;AACO;AACP;AACA","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.ts\");\n","/**\r\n * Simple boilerplate avoidance class for requestAnimationFrame looping\r\n * which runs an array of tasks you specify for frame. It's not clever -\r\n * it assumes you're keeping your frame tasks fast.\r\n */\r\nexport class AnimLoopEngine {\r\n    constructor() {\r\n        this.frameReqId = 0;\r\n        this.frameTasks = [];\r\n        this.lastFrameTaskId = 0;\r\n        this.tsPrev = 0; // Previous timestamp\r\n        this.tick = (ts = 0) => {\r\n            if (this.tsPrev === null) {\r\n                this.tsPrev = ts;\r\n            }\r\n            let i = 0;\r\n            let dt = (ts - this.tsPrev) / 1000;\r\n            while (i < this.frameTasks.length) {\r\n                this.frameTasks[i].fn(ts, dt);\r\n                i++;\r\n            }\r\n            this.tsPrev = ts;\r\n            this.frameReqId = window.requestAnimationFrame(this.tick);\r\n        };\r\n        this.addTasks = this.addTasks.bind(this);\r\n    }\r\n    addTask(task) {\r\n        return this.addTasks([task])[0];\r\n    }\r\n    addTasks(tasks) {\r\n        const createdIds = [];\r\n        if (tasks.length == 0) {\r\n            return createdIds;\r\n        }\r\n        tasks.forEach(task => {\r\n            this.frameTasks.push({ id: this.lastFrameTaskId, fn: task });\r\n            createdIds.push(this.lastFrameTaskId);\r\n            this.lastFrameTaskId++;\r\n        });\r\n        return createdIds;\r\n    }\r\n    deleteTask(taskId) {\r\n        this.frameTasks = this.frameTasks.filter(t => t.id !== taskId);\r\n    }\r\n    start() {\r\n        this.tsPrev = null;\r\n        this.frameReqId = window.requestAnimationFrame(this.tick);\r\n    }\r\n    stop() {\r\n        window.cancelAnimationFrame(this.frameReqId);\r\n        this.frameReqId = null;\r\n    }\r\n}\r\n//# sourceMappingURL=index.js.map","import { drawWithMode } from './mode';\r\nexport const arc = (cx, x, y, radius, radFrom, radTo, mode, antiClockwise = false) => {\r\n    cx.beginPath();\r\n    cx.arc(x, y, radius, radFrom, radTo, antiClockwise);\r\n    drawWithMode(cx, mode);\r\n};\r\n","import { drawWithMode } from './mode';\r\nexport const line = (cx, points, mode, close) => {\r\n    cx.beginPath();\r\n    // console.log(points);\r\n    cx.moveTo(points[0][0], points[0][1]);\r\n    for (let i = 1; i < points.length; i++) {\r\n        cx.lineTo(points[i][0], points[i][1]);\r\n    }\r\n    if (close) {\r\n        cx.lineTo(points[0][0], points[0][1]);\r\n    }\r\n    drawWithMode(cx, mode);\r\n};\r\n","var DrawModes;\r\n(function (DrawModes) {\r\n    DrawModes[DrawModes[\"f\"] = 0] = \"f\";\r\n    DrawModes[DrawModes[\"s\"] = 1] = \"s\";\r\n    DrawModes[DrawModes[\"fs\"] = 2] = \"fs\";\r\n    DrawModes[DrawModes[\"sf\"] = 3] = \"sf\"; // Stroke then fill\r\n})(DrawModes || (DrawModes = {}));\r\nexport const drawWithMode = (cx, mode) => {\r\n    switch (mode) {\r\n        case 'f':\r\n            cx.fill();\r\n            break;\r\n        case 's':\r\n            cx.stroke();\r\n            break;\r\n        case 'fs':\r\n            cx.fill();\r\n            cx.stroke();\r\n            break;\r\n        case 'sf':\r\n            cx.stroke();\r\n            cx.fill();\r\n            break;\r\n    }\r\n};\r\n","export class Easel {\r\n    constructor(id, opts) {\r\n        return this.bindTo(id, opts);\r\n    }\r\n    bindTo(id, opts) {\r\n        this.cv = document.getElementById(id);\r\n        this.cx = this.cv.getContext('2d');\r\n        this.setupCanvas(opts);\r\n        return this;\r\n    }\r\n    setupCanvas(opts) {\r\n        if (opts) {\r\n            if (typeof opts.tabIndex !== 'undefined') {\r\n                this.cv.tabIndex = opts.tabIndex;\r\n            }\r\n            if (opts.focus) {\r\n                this.cv.focus();\r\n            }\r\n        }\r\n        const cvStyle = window.getComputedStyle(this.cv);\r\n        this.cv.setAttribute('width', cvStyle.width);\r\n        this.cv.setAttribute('height', cvStyle.height);\r\n        this.w = parseInt(cvStyle.width);\r\n        this.h = parseInt(cvStyle.height);\r\n        this.rt = this.cv.getBoundingClientRect();\r\n    }\r\n    config(conf) {\r\n        for (let i in conf) {\r\n            this.cx[i] = conf[i];\r\n        }\r\n    }\r\n    wipe() {\r\n        this.cx.clearRect(0, 0, this.w, this.h);\r\n    }\r\n}\r\n","var Bullet = /** @class */ (function () {\r\n    function Bullet(x, y, vx, vy) {\r\n        if (x === void 0) { x = 0; }\r\n        if (y === void 0) { y = 0; }\r\n        if (vx === void 0) { vx = 0; }\r\n        if (vy === void 0) { vy = 0; }\r\n        this.x = x;\r\n        this.y = y;\r\n        this.vx = vx;\r\n        this.vy = vy;\r\n    }\r\n    return Bullet;\r\n}());\r\nexport { Bullet };\r\n","var Player = /** @class */ (function () {\r\n    function Player(x, y, scale) {\r\n        if (x === void 0) { x = 0; }\r\n        if (y === void 0) { y = 0; }\r\n        if (scale === void 0) { scale = 1; }\r\n        this.x = x;\r\n        this.y = y;\r\n        this.scale = scale;\r\n        this.s = [];\r\n        this.r = 0;\r\n        this.radius = 14;\r\n        this.reverse = false;\r\n        this.thrust = false;\r\n        this.vx = 0;\r\n        this.vy = 0;\r\n        this.va = 0;\r\n        this.tx = 0; // Target x - gives x something to aspire to\r\n        this.ty = 0; // Target y - gives y something to aspire to\r\n    }\r\n    Player.prototype.getShape = function () {\r\n        return !this.thrust\r\n            ? [\r\n                [0, -14],\r\n                [10, 10],\r\n                [0, 7],\r\n                [-10, 10]\r\n            ]\r\n            : [\r\n                [0, -14],\r\n                [10, 10],\r\n                [0, 7],\r\n                [5, 9],\r\n                [0, 7 + Math.random() * 10],\r\n                [-5, 9],\r\n                [0, 7],\r\n                [-10, 10]\r\n            ];\r\n    };\r\n    return Player;\r\n}());\r\nexport { Player };\r\n","var Rock = /** @class */ (function () {\r\n    function Rock(x, y, vx, vy, va, radius, gen) {\r\n        if (x === void 0) { x = 0; }\r\n        if (y === void 0) { y = 0; }\r\n        if (vx === void 0) { vx = 0; }\r\n        if (vy === void 0) { vy = 0; }\r\n        if (va === void 0) { va = 0; }\r\n        if (radius === void 0) { radius = 1; }\r\n        this.x = x;\r\n        this.y = y;\r\n        this.vx = vx;\r\n        this.vy = vy;\r\n        this.va = va;\r\n        this.radius = radius;\r\n        this.s = [];\r\n        this.r = 0;\r\n        this.gen = 1; // Generation - 1 = 1st, 2 = 2nd, 3 = 3rd and last\r\n        if (gen) {\r\n            this.gen = gen;\r\n        }\r\n    }\r\n    Rock.prototype.getShape = function () {\r\n        if (this.s.length > 0) {\r\n            return this.s;\r\n        }\r\n        var div = 7;\r\n        var angle = (2 * Math.PI) / div;\r\n        for (var i = 0; i < div; i++) {\r\n            this.s.push([\r\n                Math.sin(i * angle) * (Math.random() * 10 + this.radius - 5),\r\n                Math.cos(i * angle) * (Math.random() * 10 + this.radius - 5)\r\n            ]);\r\n        }\r\n        return this.s;\r\n    };\r\n    return Rock;\r\n}());\r\nexport { Rock };\r\n","// import { AnimLoopEngine } from 'anim-loop-engine';\r\nimport { AnimLoopEngine } from '../../anim-loop-engine/lib/index';\r\n// import { Easel } from '../../easel-js/lib/index';\r\n// import { arc } from '../../easel-js/lib/draw/arc';\r\n// import { line } from '../../easel-js/lib/draw/line';\r\n// import { rect } from '../../easel-js/lib/draw/rect';\r\nimport { Easel } from 'easel-js';\r\nimport { arc } from 'easel-js/lib/draw/arc';\r\nimport { line } from 'easel-js/lib/draw/line';\r\nimport { degreesToRadians } from './utils/math';\r\nimport { Bullet } from './entities/Bullet';\r\nimport { Player } from './entities/Player';\r\nimport { Rock } from './entities/Rock';\r\nvar initNumRocks = 4;\r\nvar gameHasFocus = true;\r\nvar paused = false;\r\nvar fired = false;\r\nvar engine = new AnimLoopEngine();\r\nvar easel = new Easel('sr', { tabIndex: 0, focus: true });\r\neasel.config({\r\n    fillStyle: '#FFF',\r\n    font: '50px VT323',\r\n    lineWidth: 2,\r\n    strokeStyle: '#FFF',\r\n    textAlign: 'center',\r\n    textBaseline: 'middle'\r\n});\r\nvar scalingBase = easel.w > easel.h ? easel.w : easel.h;\r\nvar rockRadius = scalingBase / 15;\r\nvar rockBaseVel = scalingBase / 15;\r\nvar calcRockSpawnCoord = function (axis) {\r\n    if (axis === 'x') {\r\n        return Math.random() < 0.5\r\n            ? (easel.w / 4) * Math.random()\r\n            : (easel.w / 4) * Math.random() + (easel.w / 3) * 2;\r\n    }\r\n    else {\r\n        return Math.random() < 0.5\r\n            ? (easel.h / 4) * Math.random()\r\n            : (easel.h / 4) * Math.random() + (easel.h / 3) * 2;\r\n    }\r\n};\r\nvar rotateShape = function (shape, angle) {\r\n    var rad = degreesToRadians(angle);\r\n    var rShape = [];\r\n    for (var i = 0; i < shape.length; i++) {\r\n        rShape[i] = [\r\n            shape[i][0] * Math.cos(rad) - shape[i][1] * Math.sin(rad),\r\n            shape[i][0] * Math.sin(rad) + shape[i][1] * Math.cos(rad)\r\n        ];\r\n    }\r\n    return rShape;\r\n};\r\n// const scaleShape = (entity: Player | Rock) => {\r\n//   const s = entity.getShape();\r\n//   for (let i = 0; i < s.length; i++) {\r\n//     s[i][0] *= 1;\r\n//     s[i][1] *= 1;\r\n//   }\r\n//   return entity;\r\n// };\r\nvar translateShape = function (shape, matrix) {\r\n    var tShape = [];\r\n    for (var i = 0; i < shape.length; i++) {\r\n        tShape[i] = [shape[i][0] + matrix[0], shape[i][1] + matrix[1]];\r\n    }\r\n    return tShape;\r\n};\r\nvar randomNeg = function () { return (Math.random() < 0.5 ? 1 : -1); };\r\n// GENERATE SHIT\r\nvar aBullets = [];\r\n// Gen player\r\nvar player = new Player();\r\n// Gen rocks\r\nvar aRocks = [];\r\nfor (var i = 0; i < 4; i++) {\r\n    var vx = (Math.random() * rockBaseVel + 15) * randomNeg();\r\n    var vy = (Math.random() * rockBaseVel + 15) * randomNeg();\r\n    aRocks.push(new Rock(calcRockSpawnCoord('x'), calcRockSpawnCoord('y'), vx, vy, Math.random() * 100 * randomNeg(), rockRadius));\r\n}\r\n// Gen rock's screen boundaries\r\nvar genRockInner = function (radius) {\r\n    return [0 + radius, easel.w - radius, easel.h - radius, 0 + radius];\r\n};\r\n// Draw an entity shape at calced location and rotation\r\nvar drawEntity = function (entity, dt, fill) {\r\n    if (dt === void 0) { dt = 0; }\r\n    var drawable = [];\r\n    // Screen wrap boundaries\r\n    var inner = genRockInner(entity.radius);\r\n    // Don't accrue large spin angles\r\n    if (entity.r > 360) {\r\n        entity.r -= 360;\r\n    }\r\n    else if (entity.r < -360) {\r\n        entity.r += 360;\r\n    }\r\n    // Wrap main rock at screen edges\r\n    // x < 0\r\n    if (entity.x < 0) {\r\n        entity.x += easel.w;\r\n    }\r\n    // x > width\r\n    else if (entity.x > easel.w) {\r\n        entity.x -= easel.w;\r\n    }\r\n    // y < 0\r\n    if (entity.y < 0) {\r\n        entity.y += easel.h;\r\n    }\r\n    // y > height\r\n    if (entity.y > easel.h) {\r\n        entity.y -= easel.h;\r\n    }\r\n    // Add main rock to drawable array\r\n    drawable.push([entity.x, entity.y]);\r\n    // Check for boundary overlap to generate faux-rocks:\r\n    // Top left\r\n    if (entity.x < inner[3] && entity.y < inner[0]) {\r\n        drawable.push([entity.x, entity.y + easel.h], [entity.x + easel.w, entity.y], [entity.x + easel.w, entity.y + easel.h]);\r\n    }\r\n    // Top right\r\n    else if (entity.x > inner[1] && entity.y < inner[0]) {\r\n        drawable.push([entity.x - easel.w, entity.y], [entity.x - easel.w, entity.y + easel.h], [entity.x, entity.y + easel.h]);\r\n    }\r\n    // Bottom right\r\n    else if (entity.x > inner[1] && entity.y < inner[2]) {\r\n        drawable.push([entity.x - easel.w, entity.y - easel.h], [entity.x, entity.y - easel.h], [entity.x - easel.w, entity.y]);\r\n    }\r\n    // Bottom left\r\n    else if (entity.x < inner[3] && entity.y > inner[2]) {\r\n        drawable.push([entity.x, entity.y - easel.h], [entity.x + easel.w, entity.y - easel.h], [entity.x + easel.w, entity.y]);\r\n    }\r\n    // Top\r\n    else if (entity.y < inner[0]) {\r\n        drawable.push([entity.x, entity.y + easel.h]);\r\n    }\r\n    // Right\r\n    else if (entity.x > inner[1]) {\r\n        drawable.push([entity.x - easel.w, entity.y]);\r\n    }\r\n    // Bottom\r\n    else if (entity.y > inner[2]) {\r\n        drawable.push([entity.x, entity.y - easel.h]);\r\n    }\r\n    // Left\r\n    else if (entity.x < inner[3]) {\r\n        drawable.push([entity.x + easel.w, entity.y]);\r\n    }\r\n    var j = 0;\r\n    while (j < drawable.length) {\r\n        line(easel.cx, translateShape(rotateShape(entity.getShape(), entity.r), drawable[j]), fill ? 'fs' : 's', true);\r\n        j++;\r\n    }\r\n};\r\n// Calculate and draw new rock positions\r\nvar drawRocks = function (dt) {\r\n    if (dt === void 0) { dt = 0; }\r\n    var i = 0;\r\n    while (i < aRocks.length) {\r\n        var r = aRocks[i];\r\n        r.x += r.vx * dt;\r\n        r.y += r.vy * dt;\r\n        r.r += r.va * dt;\r\n        // Don't accrue large spin angles\r\n        if (r.r > 360) {\r\n            r.r -= 360;\r\n        }\r\n        else if (r.r < -360) {\r\n            r.r += 360;\r\n        }\r\n        drawEntity(r, dt);\r\n        i++;\r\n    }\r\n};\r\n// Calculate and draw player ship\r\nvar drawPlayer = function (dt) {\r\n    if (dt === void 0) { dt = 0; }\r\n    player.x = player.x !== 0 ? player.x : easel.w / 2;\r\n    player.y = player.y !== 0 ? player.y : easel.h / 2;\r\n    player.r += player.va * dt;\r\n    if (player.thrust || player.reverse) {\r\n        player.tx =\r\n            Math.sin(degreesToRadians(player.reverse ? player.r + 180 : player.r)) *\r\n                400;\r\n        player.ty =\r\n            -Math.cos(degreesToRadians(player.reverse ? player.r + 180 : player.r)) *\r\n                400;\r\n        if (player.vx < player.tx || player.vx > player.tx) {\r\n            player.vx += player.reverse\r\n                ? (player.tx / 2 - player.vx) * dt\r\n                : (player.tx - player.vx) * dt;\r\n        }\r\n        if (player.vy < player.ty || player.vy > player.ty) {\r\n            player.vy += player.reverse\r\n                ? (player.ty / 2 - player.vy) * dt\r\n                : (player.ty - player.vy) * dt;\r\n        }\r\n    }\r\n    player.x += player.vx * dt;\r\n    player.y += player.vy * dt;\r\n    drawEntity(player, dt);\r\n};\r\n// Fire a bullet\r\nvar fireBullet = function () {\r\n    var rad = degreesToRadians(player.r);\r\n    aBullets.push(new Bullet(player.x + Math.sin(rad) * 14, player.y + -Math.cos(rad) * 14, player.vx + Math.sin(rad) * 350, player.vy + -Math.cos(rad) * 350));\r\n};\r\n// Draw bullets\r\nvar drawBullets = function (dt) {\r\n    var i = 0;\r\n    while (i < aBullets.length) {\r\n        var b = aBullets[i];\r\n        b.x += b.vx * dt;\r\n        b.y += b.vy * dt;\r\n        arc(easel.cx, b.x, b.y, 2, 0, 2 * Math.PI, 'f');\r\n        if (b.x < 0 || b.x > easel.w || b.y < 0 || b.y > easel.h) {\r\n            delete aBullets[i];\r\n            aBullets = aBullets.filter(function (b) { return typeof b !== 'undefined'; });\r\n        }\r\n        i++;\r\n    }\r\n};\r\n// Call updates and redraws for all entities\r\nvar update = function (ts, dt) {\r\n    if (ts === void 0) { ts = 0; }\r\n    if (dt === void 0) { dt = 0; }\r\n    if (paused || !gameHasFocus) {\r\n        return;\r\n    }\r\n    easel.wipe();\r\n    drawRocks(dt);\r\n    drawPlayer(dt);\r\n    drawBullets(dt);\r\n    easel.cx.fillText('Space Rocks: Space Rocks!', easel.w / 2, easel.h / 2 - 100);\r\n};\r\nengine.addTask(update);\r\nvar start = function () {\r\n    paused = false;\r\n    console.log('START');\r\n    engine.start();\r\n};\r\nvar stop = function () {\r\n    paused = true;\r\n    console.log('STOP');\r\n    engine.stop();\r\n};\r\n// 37, 38, 39, left up, right\r\neasel.cv.onkeydown = function (e) {\r\n    switch (e.keyCode) {\r\n        case 38: // Up\r\n            player.thrust = true;\r\n            break;\r\n        case 40: // Down\r\n            player.reverse = true;\r\n            // player.vx *= -0.2;\r\n            // player.vy *= -0.2;\r\n            break;\r\n        case 37: // Left\r\n            player.va = -300;\r\n            break;\r\n        case 39: // Right\r\n            player.va = 300;\r\n            break;\r\n        case 32: // Space (fire)\r\n            if (!fired) {\r\n                fired = true;\r\n                fireBullet();\r\n            }\r\n            break;\r\n    }\r\n};\r\neasel.cv.onkeyup = function (e) {\r\n    switch (e.keyCode) {\r\n        case 38: // Up\r\n            player.thrust = false;\r\n            break;\r\n        case 40: // Down\r\n            player.reverse = false;\r\n            break;\r\n        case 37: // Left\r\n        case 39: // Right\r\n            player.va = 0;\r\n            break;\r\n        case 32: // Space (stop firing)\r\n            fired = false;\r\n            break;\r\n    }\r\n};\r\n// FOCUS/BLUR\r\neasel.cv.onblur = function () {\r\n    gameHasFocus = false;\r\n    console.log('BLUR');\r\n    stop();\r\n};\r\neasel.cv.onfocus = function () {\r\n    gameHasFocus = true;\r\n    console.log('FOCUS');\r\n    start();\r\n};\r\nstart();\r\n","export var degreesToRadians = function (d) {\r\n    return ((2 * Math.PI) / 360) * d;\r\n};\r\nexport var radiansToDegrees = function (r) {\r\n    return (360 / (2 * Math.PI)) * r;\r\n};\r\n"],"sourceRoot":""}